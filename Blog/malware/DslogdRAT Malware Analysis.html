<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DslogdRAT Malware Analysis Report</title>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      background-color: #f4f4f4;
      margin: 0;
      padding: 0;
      color: #333;
    }

    .container {
      max-width: 900px;
      margin: 2rem auto;
      padding: 2rem;
      background: white;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    h1, h2, h3 {
      color: #003366;
    }

    h1 {
      font-size: 2rem;
      text-align: center;
      margin-bottom: 1rem;
    }

    h2 {
      margin-top: 2rem;
      font-size: 1.4rem;
    }

    p {
      margin-bottom: 1rem;
      line-height: 1.6;
    }

    code, pre {
      background-color: #f2f2f2;
      padding: 0.5rem;
      display: block;
      margin: 1rem 0;
      border-left: 4px solid #003366;
      white-space: pre-wrap;
    }

    .highlight {
      background-color: #e8f0fe;
      padding: 1rem;
      border-left: 5px solid #0073e6;
      margin-bottom: 1rem;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
      background: #fafafa;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 0.6rem;
      text-align: left;
    }

    th {
      background-color: #f0f0f0;
      color: #003366;
    }

    ul {
      margin-left: 1.5rem;
    }

    footer {
      font-size: 0.9rem;
      text-align: center;
      border-top: 1px solid #ccc;
      margin-top: 2rem;
      padding-top: 1rem;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üêö DslogdRAT Malware Analysis Report</h1>

    <h2>üìÑ Executive Summary</h2>
    <p>
      DslogdRAT is a Linux-based Remote Access Trojan targeting Ivanti Connect Secure VPN appliances, first seen in December 2024. It leverages zero-day vulnerabilities CVE‚Äë2025‚Äë0282 and CVE‚Äë2025‚Äë22457, later tied to China-nexus APT group UNC5221 (merged with UNC5337).
      Featuring time-restricted communication, multi-stage process forking, and firmware-level persistence, DslogdRAT provides remote shell access, file operations, and proxy tunneling while remaining covert.
    </p>

    <div class="highlight">
      <strong>C2 IP:</strong> 3.112.192[.]119<br />
      <strong>Activity Window:</strong> 08:00‚Äì20:00 (configurable)<br />
      <strong>Persistence:</strong> Firmware-embedded, survives patching/reboots
    </div>

    <h2>üß¨ Malware Overview</h2>
    <ul>
      <li><strong>Name:</strong> DslogdRAT</li>
      <li><strong>Type:</strong> Remote Access Trojan (RAT)</li>
      <li><strong>Platform:</strong> Ivanti Connect Secure (Linux-based)</li>
      <li><strong>Language:</strong> C (with Perl CGI loader)</li>
      <li><strong>Delivery:</strong> Web shell via CVE‚Äë2025‚Äë0282 exploitation</li>
      <li><strong>Persistence:</strong> Firmware-level</li>
      <li><strong>Attribution:</strong> UNC5221 / UNC5337 (China-linked APT)</li>
    </ul>

    <h2>üõ†Ô∏è Infection & Execution Flow</h2>
    <img src="asset/dslogdrat.png" alt="Execution Flow" style="max-width:80%; height:auto; display:block; margin: 1rem auto;" />

    <h3>Initial Access</h3>
    <ul>
      <li><strong>Exploited:</strong> CVE‚Äë2025‚Äë0282 (stack overflow, unauthenticated RCE)</li>
      <li><strong>Web Shell:</strong> <code>/dana-na/cc/ccupdate.cgi</code> triggered by cookie <code>DSAUTOKEN=af95380019083db5</code></li>
    </ul>

    <h3>Execution Stages</h3>
    <ol>
      <li><strong>Stage 0:</strong> Parent launches, spawns child, exits</li>
      <li><strong>Stage 1:</strong> XOR-decrypts config ‚Üí idle loop ‚Üí spawns RAT</li>
      <li><strong>Stage 2:</strong> RAT connects to C2, spawns thread, executes commands</li>
    </ol>

    <h2>üîç Configuration Offsets</h2>
    <table>
      <tr>
        <th>Offset</th>
        <th>Description</th>
      </tr>
      <tr><td>0x0</td><td>ConfigTag (identifier)</td></tr>
      <tr><td>0x4</td><td>Listen mode flag</td></tr>
      <tr><td>0x8</td><td>C2 IP</td></tr>
      <tr><td>0x108</td><td>C2 Port</td></tr>
      <tr><td>0x10C</td><td>Sleep time (ms)</td></tr>
      <tr><td>0x110</td><td>Timeout value</td></tr>
      <tr><td>0x114</td><td>Shell filepath</td></tr>
      <tr><td>0x214</td><td>Shell disguise string</td></tr>
      <tr><td>0x314</td><td>RAT worker thread name</td></tr>
      <tr><td>0x414</td><td>Node name string</td></tr>
      <tr><td>0x514</td><td>Proxy server</td></tr>
      <tr><td>0x614</td><td>Proxy user</td></tr>
      <tr><td>0x714</td><td>Proxy password</td></tr>
      <tr><td>0x814</td><td>Proxy port</td></tr>
      <tr><td>0x818</td><td>Lower hour limit (start)</td></tr>
      <tr><td>0x81C</td><td>Upper hour limit (end)</td></tr>
      <tr><td>0x820</td><td>Enable source port</td></tr>
      <tr><td>0x824</td><td>setsockopt() value</td></tr>
      <tr><td>0x828</td><td>Source port</td></tr>
      <tr><td>0x82C</td><td>Enable sleep flag</td></tr>
      <tr><td>0x830</td><td>Duplicate sleep flag</td></tr>
    </table>

    <h2>üß™ Command Reference Table</h2>
    <table>
      <tr>
        <th>Opcode (Hex)</th>
        <th>Command</th>
        <th>Description</th>
      </tr>
      <tr><td>0x04</td><td>File Download</td><td>Send files from host to C2</td></tr>
      <tr><td>0x08</td><td>Set Upload File</td><td>Prepare for file upload</td></tr>
      <tr><td>0x0A</td><td>File Upload</td><td>Receive file from C2</td></tr>
      <tr><td>0x0C</td><td>Shell</td><td>Launch remote shell session</td></tr>
      <tr><td>0x0D</td><td>Get Shell Data</td><td>Send command output to C2</td></tr>
      <tr><td>0x0E</td><td>Exit Shell</td><td>Close shell session</td></tr>
      <tr><td>0x11</td><td>Set Sleep Time</td><td>Adjust RAT sleep cycle</td></tr>
      <tr><td>0x13</td><td>Run Proxy</td><td>Start tunneling function</td></tr>
      <tr><td>0x16</td><td>Get Proxy Data</td><td>Receive tunneled traffic</td></tr>
      <tr><td>0x17</td><td>Stop Proxy</td><td>Stop specific proxy</td></tr>
      <tr><td>0x18</td><td>Stop All Proxies</td><td>Terminate all proxy sessions</td></tr>
      <tr><td>0x28</td><td>Forwarding</td><td>Enable traffic forwarding</td></tr>
      <tr><td>0x29</td><td>Stop Forwarding</td><td>Disable traffic forwarding</td></tr>
    </table>

    <h2>üìÅ Known Malware File Paths & Hashes</h2>
    <table>
      <tr>
        <th>File</th>
        <th>Path</th>
        <th>SHA256 Hash</th>
      </tr>
      <tr>
        <td>DslogdRAT</td>
        <td>/home/bin/dslogd</td>
        <td>1dd64c00f061425d484dd67b359ad99df533aa430632c55fa7e7617b55dab6a8</td>
      </tr>
      <tr>
        <td>Webshell</td>
        <td>/home/webserver/htdocs/dana-na/cc/ccupdate.cgi</td>
        <td>f48857263991eea1880de0f62b3d1d37101c2e7739dcd8629b24260d08850f9c</td>
      </tr>
      <tr>
        <td>SPAWNSNARE</td>
        <td>/bin/dsmain</td>
        <td>b1221000f43734436ec8022caaa34b133f4581ca3ae8eccd8d57ea62573f301d</td>
      </tr>
    </table>

    <h2>üõ°Ô∏è Mitigation & Response</h2>
    <ul>
      <li>Update ICS to version 22.7R2.6 or later</li>
      <li>Factory reset infected appliances (firmware persistence)</li>
      <li>Monitor for web shell paths and DSAUTOKEN cookies</li>
      <li>Detect XOR-encoded TCP traffic during 08:00‚Äì20:00</li>
      <li>Deploy YARA/Sigma rules to detect opcode/XOR patterns</li>
    </ul>

    <h2>‚úÖ Conclusion</h2>
    <p>
      DslogdRAT is a sophisticated threat targeting VPN infrastructure with time-based evasion, firmware persistence, and stealthy RAT capabilities. Immediate patching, behavioral detection, and full appliance resets are vital to stop reinfection and long-term espionage.
    </p>

    <footer>
      üîê Secure your perimeter. Audit your firmware. Respond with urgency.<br />
      &copy; 2025 Cyberkiller‚Äôs Report Series
    </footer>
  </div>
</body>
</html>

