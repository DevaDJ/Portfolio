<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Auto‚Äëcolor ELF Malware Analysis Report</title>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      background-color: #f4f4f4;
      margin: 0;
      padding: 0;
      color: #333;
    }

    .container {
      max-width: 800px;
      margin: 2rem auto;
      padding: 2rem;
      background: white;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    h1, h2, h3 {
      color: #003366;
    }

    h1 {
      font-size: 2rem;
      text-align: center;
      margin-bottom: 1rem;
    }

    h2 {
      margin-top: 2rem;
      font-size: 1.4rem;
    }

    p {
      margin-bottom: 1rem;
      line-height: 1.6;
    }

    code, pre {
      background-color: #f2f2f2;
      padding: 0.5rem;
      display: block;
      margin: 1rem 0;
      border-left: 4px solid #003366;
      white-space: pre-wrap;
    }

    .highlight {
      background-color: #e8f0fe;
      padding: 1rem;
      border-left: 5px solid #0073e6;
      margin-bottom: 1rem;
    }

    ul {
      margin-left: 1.5rem;
    }

    a {
      color: #0066cc;
    }

    footer {
      font-size: 0.9rem;
      text-align: center;
      border-top: 1px solid #ccc;
      margin-top: 2rem;
      padding-top: 1rem;
    }

    img {
      width: 100%;
      margin: 1rem 0;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üîç Auto‚Äëcolor ELF Malware Analysis Report</h1>

    <h2>üìÑ Executive Summary</h2>
    <p>
      Auto‚Äëcolor is a 64-bit ELF malware targeting Linux systems. First observed in April 2025, it uses <strong>LD_PRELOAD injection</strong> for persistence, drops auxiliary payloads under /var/log/cross/, and connects to a C2 domain check.linux-kernel.xyz. 
      It performs privilege escalation, reads sensitive files, and modifies file permissions to maintain stealth and control.
    </p>

    <div class="highlight">
      <strong>C2 Domain:</strong> check.linux-kernel.xyz<br />
      <strong>IP:</strong> 18.167.12.195<br />
      <strong>Communication Port:</strong> 5353 (abused)
    </div>

    <h2>üß¨ Malware Overview</h2>
    <ul>
      <li><strong>Name:</strong> Auto‚Äëcolor (auto_color.elf)</li>
      <li><strong>Type:</strong> Linux Backdoor / LD_PRELOAD Malware</li>
      <li><strong>Platform:</strong> Ubuntu Linux (22.04.2 tested)</li>
      <li><strong>Format:</strong> ELF 64‚Äëbit, dynamically linked, stripped</li>
      <li><strong>Size:</strong> ~216 KB</li>
      <li><strong>First Seen:</strong> April 19, 2025</li>
      <li><strong>Interpreter:</strong> /lib64/ld-linux-x86-64.so.2</li>
    </ul>

    <h2>‚öôÔ∏è Infection & Execution Flow</h2>
    <img src="auto_color.png" alt="Execution Flow" style="max-width:80%; height:auto; display:block; margin: 1rem auto;" />
    <h3>Initial Execution:</h3>
    <ul>
      <li>Executed via <i>sudo</i> with root privileges</li>
      <li>Run from a parent shell using:<i> chown + chmod +x + sudo -i ./auto_color.elf</i></li>
    </ul>

    <h3>Behavioral Flow:</h3>
    <ol>
      <li>Reads passwd and other profile files <code>/etc/passwd</code> </li>
      <li>Creates directory and files under <code>/var/log/cross/</code></li>
      <li>Drops malicious shared object: <code>libcext.so.2</code></li>
      <li>Modifies ld.so.preload for persistence<code>/etc/ld.so.preload</code> </li>
      <li>Spawns shell processes: bash, dash, locale-check</li>
    </ol>

    <h2>üì¶ Static Analysis</h2>
    <ul>
      <li><strong>MIME:</strong> application/x-pie-executable</li>
      <li><strong>Architecture:</strong> x86‚Äë64 (Little Endian)</li>
      <li><strong>Build ID:</strong> 08a8401aef311e569e8bcbc3b46829560334ec0a</li>
      <li><strong>Stripped:</strong> Yes</li>
      <li><strong>Linked As:</strong> Shared object</li>
    </ul>

    <h3>Hashes:</h3>
    <pre>
MD5: a30f5c43b437c940a4d5e940d37106ca
SHA1: f91623fa3d8c69b0a3fc1ed2172290af492be37b
SHA256: e463921880458ee1de65cc3f77ae07a3b9a3ae151de8b6c52ea382c8d6146b0f
    </pre>

    <h2>üß™ Dynamic Behavior</h2>
    <ul>
      <li>Drops files in <code>/var/log/cross/</code></li>
      <li>Creates  (malicious shared object) <code>/usr/lib/x86_64-linux-gnu/libcext.so.2</code></li>
      <li>Edits for runtime injection<code>/etc/ld.so.preload</code> </li>
      <li>Spawns shell commands and reads sensitive files</li>
    </ul>

    <h2>üåê Network Activity</h2>
    <ul>
      <li><strong>Domain:</strong> check.linux-kernel.xyz</li>
      <li><strong>IP:</strong> 18.167.12.195 (Amazon AWS - HK)</li>
      <li><strong>Port:</strong> 5353 (C2 over non-standard port)</li>
      <li><strong>Other Traffic:</strong> connectivity-check.ubuntu.com, snapcraft, GNOME services</li>
    </ul>

    <h2>üõë Indicators of Compromise (IOCs)</h2>
    <h3>File Paths:</h3>
    <ul>
      <li><code>/home/user/Desktop/auto_color.elf</code></li>
      <li><code>/var/log/cross/auto-color</code></li>
      <li><code>/usr/lib/x86_64-linux-gnu/libcext.so.2</code></li>
      <li><code>/etc/ld.so.preload</code></li>
    </ul>

    <h2>üéØ MITRE ATT&CK Techniques</h2>
    <ul>
      <li><strong>Initial Access:</strong> T1078 ‚Äì Valid Accounts (sudo misuse)</li>
      <li><strong>Execution:</strong> T1059 ‚Äì Command & Scripting Interpreter</li>
      <li><strong>Persistence:</strong> T1574.006 ‚Äì LD_PRELOAD Hijacking</li>
      <li><strong>Privilege Escalation:</strong> T1068 ‚Äì Exploitation via sudo</li>
      <li><strong>Defense Evasion:</strong> T1027 ‚Äì Obfuscated Files (stripped ELF)</li>
      <li><strong>Credential Access:</strong> T1003 ‚Äì Reads /etc/passwd</li>
      <li><strong>C2:</strong> T1071.001 ‚Äì Application Layer Protocol</li>
    </ul>

    <h2>üîê Mitigation & Recommendations</h2>
    <ul>
      <li>Monitor below file  for unauthorized changes<code>/etc/ld.so.preload</code> </li>
      <li>Block IP Below IP and Domain: <code>18.167.12.195</code><code>check.linux-kernel.xyz</code></li>
      <li>Inspect below port for abnormal outbound connections<code>5353</code> </li>
      <li>Delete all the files located in below path <code>/var/log/cross/</code> <code>libcext.so.2</code></li>
      <li>Reimage systems if full cleanup is uncertain</li>
    </ul>

    <h2>üïµÔ∏è‚Äç‚ôÇÔ∏è Real-World Case: SAP NetWeaver Exploit</h2>
    <p>
      In April 2025, attackers exploited <strong>CVE-2025-31324</strong> (SAP NetWeaver) to deliver Auto‚Äëcolor malware to a U.S. chemicals company. This marked the first observed use of an SAP RCE flaw to deploy the ELF backdoor.
    </p>

    <h3>Attack Timeline:</h3>
    <ul>
      <li><strong>April 25:</strong> SAP scanning and exploitation began</li>
      <li><strong>April 27:</strong> Payload download and DNS tunneling activity</li>
      <li><strong>April 28:</strong> Auto‚Äëcolor executed with root privileges</li>
    </ul>

    <p>
      The malware suppressed its malicious activity if C2 was unreachable, appearing benign and evading detection. This shows an advanced level of evasion logic and adaptive behavior.
    </p>

    <h2>‚úÖ Conclusion</h2>
    <p>
      Auto‚Äëcolor is a stealthy Linux ELF malware using LD_PRELOAD hijacking, stripped binaries, and system path masquerading. Its capabilities make it highly resilient and difficult to detect. Organizations should strengthen file integrity monitoring, patch management, and network egress controls to mitigate such threats.
    </p>

    <footer>
      üîí Stay vigilant. Protect your Linux systems. Spread awareness.<br />
      &copy; 2025 Cyberkiller's Blog
    </footer>
  </div>
</body>
</html>
